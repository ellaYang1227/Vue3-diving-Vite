import{s as C}from"./vue-multiselect.esm-e5bb0a7f.js";import{r as u,o as e,ak as v,w as _,b as i,u as d,bd as o,g as b,c as a,al as m,a as f,ap as w,F as y,aL as $,m as D,bw as h,b1 as A,L as V}from"./dateFormat-142bd354.js";import{g as N,b as z,A as O}from"./ActivityStore-94fe8040.js";import{d as L,C as p}from"./decimalFormat-bbefd631.js";import{s as T}from"./statusTextFormat-746565ff.js";import{p as H}from"./propsValidator-40732aba.js";import{_ as x}from"./UserMugShot-f0208e72.js";import{N as P}from"./NoData-a752637a.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import"./runtime-dom.esm-bundler-c8388b4d.js";import"./axiosBase-7f84a836.js";import"./VueStarRating.common-c3770ddc.js";import"./vue.runtime.esm-bundler-123002ef.js";const F={class:"card horizontal-card h-100"},M={class:"row g-0"},I={class:"col-sm-5 position-relative"},q=["src","alt"],j={class:"position-absolute top-0 end-0 p-1 bg-darkPrimary bg-opacity-80 fs-7 text-body"},K={class:"col-sm-7"},U={class:"card-body h-100 d-flex flex-column"},E={class:"font-barlow"},R={class:"card-title h5 mb-0 text-primary text-truncate-row-2 fw-bold"},G={key:0,class:"card-text text-truncate-row-2 white-space-pre-wrap opacity-75 mb-0"},J={class:"row align-items-center fw-bold mt-2 mt-sm-auto"},Q={class:"col text-truncate d-flex align-items-center"},W={key:0,class:"ms-1 font-barlow fw-normal"},X={class:"col-auto font-barlow list-inline mb-0"},Y={class:"list-inline-item"},Z={key:0,class:"list-inline-item"},tt={key:1,class:"list-inline-item"},it={props:{activity:{type:Object,required:!0,validator(t){return H("HorizontalActivityCard",t,["id","title","imgs","location","startDate","endDate","isNitrox","cylinderTotalId","user"])}}},components:{UserMugShot:x}},et=Object.assign(it,{__name:"HorizontalActivityCard",setup(t){return(c,l)=>{const r=u("router-link");return e(),v(r,{to:`/activity/${t.activity.id}`,class:"col text-decoration-none shadow-sm"},{default:_(()=>[i("div",F,[i("div",M,[i("div",I,[i("img",{src:d(N)(t.activity.imgs).img,class:"img-fluid img-cover",alt:t.activity.title},null,8,q),i("div",j,o(t.activity.location.name),1)]),i("div",K,[i("div",U,[i("small",E,o(d(b)(t.activity.startDate))+" ~ "+o(d(b)(t.activity.endDate)),1),i("h2",R,o(t.activity.title),1),t.activity.features?(e(),a("p",G,o(t.activity.features),1)):m("",!0),i("div",J,[i("div",Q,[f(x,{"width-size":30,name:t.activity.user.name,img:t.activity.user.img},null,8,["name","img"]),t.activity.score?(e(),a("small",W,o(`(${d(L)(t.activity.score,1)})`),1)):m("",!0)]),i("ul",X,[i("li",Y,o(t.activity.certificateLevel.name),1),t.activity.isNitrox?(e(),a("li",Z,"高氧")):m("",!0),t.activity.cylinderTotalId?(e(),a("li",tt,o(t.activity.cylinderTotal.name),1)):m("",!0)])]),f(r,{to:`/activity/${t.activity.id}`,class:$(["btn btn-custom-rectangle mt-3",t.activity.isOrderPlaced||t.activity.orderStatus!==2?"btn-lightPrimary opacity-40":"btn-primary"]),role:"button"},{default:_(()=>[t.activity.isOrderPlaced?(e(),a(y,{key:0},[w("已報名")],64)):(e(),a(y,{key:1},[w(o(d(T)(t.activity.activityStatus,t.activity.orderStatus).replace("立即報名","揪團詳情")),1)],64))]),_:1},8,["to","class"])])])])])]),_:1},8,["to"])}}}),st={data(){return{activities:[],initAdActivities:[],adActivities:[],selectedSort:"",sortOptions:[{label:"更新時間",value:"updateDate"},{label:"出發時間",value:"startDate"},{label:"評論分數",value:"score"},{label:"報名人數",value:"orderTotal"}]}},computed:{...D(p,["comments"])},watch:{selectedSort:{handler(t,c){if(t){const{value:l}=t;this.activities.sort((r,s)=>l==="startDate"?r[l]>s[l]?1:-1:l==="orderTotal"?r.orders.length>s.orders.length?-1:1:r[l]>s[l]?-1:1),this.adActivities=z(this.initAdActivities,2)}}}},components:{VueMultiselect:C,HorizontalActivityCard:et,NoData:P},created(){this.$watch(()=>this.$route.query,()=>{const{path:t}=this.$route;t.indexOf("/activities")>-1&&this.fetchData()},{immediate:!0})},methods:{...h(V,["hideLoading"]),...h(O,["getActivities","getAdActivities"]),...h(p,["getComments","setScore"]),fetchData(){this.selectedSort=null;const t=[this.getActivities(this.$route.query),this.getComments()];this.initAdActivities.length||t.push(this.getAdActivities()),Promise.all(t).then(c=>{this.activities=this.setScore(c[0]),this.initAdActivities.length||(this.initAdActivities=this.setScore(c[2])),this.selectedSort=this.sortOptions[0],this.hideLoading()})}}},at={class:"container py-4 py-md-5"},ot={class:"row align-items-center mb-2"},ct=i("h5",{class:"col fw-bold fs-4 mb-0 text-warning"},"為您精選",-1),lt={class:"col-auto btn-group ms-auto"},rt={class:"row row-cols-1 row-cols-md-2 gy-4"},nt=i("div",{class:"border-bottom opacity-30 my-4"},null,-1),dt={key:0,class:"row row-cols-1 row-cols-md-2 gy-4"};function mt(t,c,l,r,s,ut){const k=u("VueMultiselect"),g=u("HorizontalActivityCard"),S=u("NoData");return e(),a("div",at,[i("div",ot,[ct,i("div",lt,[f(k,{modelValue:s.selectedSort,"onUpdate:modelValue":c[0]||(c[0]=n=>s.selectedSort=n),options:s.sortOptions,label:"label","track-by":"label",searchable:!1},null,8,["modelValue","options"])])]),i("div",rt,[(e(!0),a(y,null,A(s.adActivities,n=>(e(),v(g,{activity:n,key:n.id},null,8,["activity"]))),128))]),nt,s.activities.length?(e(),a("div",dt,[(e(!0),a(y,null,A(s.activities,n=>(e(),v(g,{activity:n,key:n.id},null,8,["activity"]))),128))])):(e(),v(S,{key:1,text:"找不到符合條件的揪團活動，試試看其他搜尋條件吧"}))])}const Ct=B(st,[["render",mt]]);export{Ct as default};
