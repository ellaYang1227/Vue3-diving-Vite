import{a as x}from"./routeGuard-e91f4ffc.js";import{C as y,d as C}from"./decimalFormat-61690882.js";import{o as a,c as m,b as t,bd as o,m as d,bv as k,bw as _,a as h,F as f,b1 as p,L as $,r as b,ak as O,w as V,ap as M}from"./dateFormat-6c69c48f.js";import{M as u}from"./MemberStore-50669d50.js";import{_ as w}from"./UserMugShot-05128f3d.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";import"./axiosBase-c8bf13dd.js";import"./ActivityStore-c530c585.js";import"./VueStarRating.common-17b108e4.js";import"./vue.runtime.esm-bundler-a61ba88c.js";import"./runtime-dom.esm-bundler-56dfeb61.js";const A="/Vue3-diving-Vite/assets/activities-0a86f140.svg",I="/Vue3-diving-Vite/assets/commentScore-124609f6.svg",j="/Vue3-diving-Vite/assets/myOrders-45c70b3d.svg",L="/Vue3-diving-Vite/assets/orders-00cc1571.svg";const B={props:["title","imgName","value"],computed:{imgSrc(){if(this.imgName==="activitiesIcon")return A;if(this.imgName==="commentScoreIcon")return I;if(this.imgName==="myOrdersIcon")return j;if(this.imgName==="ordersIcon")return L}}},D={class:"card"},E={class:"card-body p-2 p-sm-3"},F={class:"row g-2 justify-content-between justify-content-sm-center align-items-center"},P={class:"col-auto col-sm text-center"},T=["src","alt"],q={class:"col"},z={class:"fs-3 font-barlow"},G={class:"d-block opacity-80"};function R(i,e,s,r,l,c){return a(),m("div",D,[t("div",E,[t("div",F,[t("div",P,[t("img",{src:c.imgSrc,alt:s.title,class:"icon-height"},null,8,T)]),t("div",q,[t("strong",z,o(s.value),1),t("small",G,o(s.title),1)])])])])}const S=N(B,[["render",R]]);const U={class:"container py-4 py-md-5"},H={class:"row gy-2 gy-sm-4 align-items-stretch"},J={class:"col-md-12 col-lg-5"},K={class:"card h-100"},Q={class:"row g-0 h-100"},W={class:"col-sm-5 col-lg-6 col-xl-5 text-center"},X={class:"bg-lightPrimary bg-opacity-5 h-100 p-3 custom-rectangle d-flex flex-sm-column justify-content-center align-items-center"},Y={class:"text-truncate flex-grow-1 flex-sm-grow-0 text-start text-sm-center mt-sm-2"},Z={class:"fw-bold mb-0 text-truncate"},tt={class:"font-barlow"},et={class:"col-sm"},st={class:"card-body list-unstyled mb-0 h-100 d-flex flex-column justify-content-center"},it={class:"d-flex justify-content-between align-items-center"},ot=t("small",{class:"opacity-80"},"證照等級",-1),ct={class:"ms-2"},nt={class:"d-flex justify-content-between align-items-center py-2"},at=t("small",{class:"opacity-80"},"持有高氧證照",-1),rt={class:"ms-2"},mt={class:"d-flex justify-content-between align-items-center"},lt=t("small",{class:"opacity-80"},"潛水支數",-1),dt={class:"ms-2"},_t={class:"col"},ht={class:"row row-cols-2 g-2 g-sm-4"},ut={class:"pt-4 pt-md-5"},gt={class:"nav nav-tabs member-nav-tabs"},vt={class:"card border-top-0"},yt={class:"card-body p-4 px-md-5"},ft=u(),pt={data(){return{cards:{myOrders:{title:"報名揪團次數",value:null},commentScore:{title:"評價分數",value:null},activities:{title:"累積揪團數",value:null},orders:{title:"累積報名人數",value:null}},navTabs:[{name:"我的揪團",url:"/myActivities"},{name:"我的報名",url:"/myOrders"},{name:"評論管理",url:"/myComments"},{name:"編輯個人檔案",url:"/editMyinfo"}]}},beforeRouteEnter(i,e,s){x(i,e,s)},computed:{...d(k,["user"]),...d(u,["myinfo","myComments","myActivities","myOrders"]),...d(y,["initComments","comments"])},watch:{comments(){const{id:i}=this.user;ft.$patch(e=>{e.myComments=this.comments.find(s=>s.userId==i)})},myOrders(){this.setCards()},myComments(){this.setCards()},myActivities(){this.setCards()}},components:{UserMugShot:w,StatisticsCard:S},created(){this.$watch(()=>this.$route.query,()=>{const{path:i}=this.$route;i.indexOf("/member")>-1&&this.fetchData()},{immediate:!0})},methods:{..._($,["showLoading","hideLoading"]),..._(u,["getMyinfo","getMyActivities","getMyOrders"]),..._(y,["getComments"]),fetchData(){Promise.all([this.getMyinfo(),this.getComments(),this.getMyActivities(),this.getMyOrders()]).then(i=>{this.setCards(),this.hideLoading()})},setCards(){Object.keys(this.cards).forEach(e=>{var r;let s=0;switch(e){case"myOrders":s=this.myOrders.length;break;case"commentScore":(r=this.myComments)!=null&&r.averageScore&&(s=C(this.myComments.averageScore,1));break;case"activities":s=this.myActivities.length;break;case"orders":s=this.myActivities.reduce((l,c)=>l+c.orders.length,0);break}this.cards[e].value=s})}}},At=Object.assign(pt,{__name:"MemberView",setup(i){return(e,s)=>{var c,g;const r=b("router-link"),l=b("router-view");return a(),m("div",U,[t("div",H,[t("div",J,[t("div",K,[t("div",Q,[t("div",W,[t("div",X,[h(w,{img:e.myinfo.img,isShowName:!1,widthSize:75,class:"flex-shrink-0 me-2 me-sm-0"},null,8,["img"]),t("div",Y,[t("h5",Z,o(e.myinfo.name),1),t("small",tt,o(e.myinfo.email),1)])])]),t("div",et,[t("ul",st,[t("li",it,[ot,t("strong",ct,o((c=e.myinfo.certificateLevel)==null?void 0:c.name),1)]),t("li",nt,[at,t("strong",rt,o(e.myinfo.isNitrox?"是":"否"),1)]),t("li",mt,[lt,t("strong",dt,o((g=e.myinfo.cylinderTotal)==null?void 0:g.name),1)])])])])])]),t("div",_t,[t("div",ht,[(a(!0),m(f,null,p(e.cards,(n,v)=>(a(),m("div",{class:"col",key:v},[h(S,{title:n.title,imgName:`${v}Icon`,value:n.value},null,8,["title","imgName","value"])]))),128))])])]),t("div",ut,[t("nav",gt,[(a(!0),m(f,null,p(e.navTabs,n=>(a(),O(r,{class:"nav-link",to:`/member${n.url}`,key:n.name},{default:V(()=>[M(o(n.name),1)]),_:2},1032,["to"]))),128))]),t("div",vt,[t("div",yt,[h(l)])])])])}}});export{At as default};
