import{bv as m,bx as u}from"./dateFormat-142bd354.js";import{b as s,s as o}from"./axiosBase-7f84a836.js";import{A as p,a as h}from"./ActivityStore-94fe8040.js";import{M as f}from"./MemberStore-1395dbee.js";const{getStorageUser:g}=m(),{getActivity:S}=p(),{getMyOrders:l}=f(),b=u("OrderStore",{state:()=>({}),getters:{},actions:{getFilterIsDeleteOrders(){return s.get("orders?isDelete=0").then(e=>Promise.resolve(e)).catch(e=>Promise.reject(!1))},getSearchOrdersForActivityId(e){const r=["_expand=user","_sort=updateDate","_order=desc","isDelete=0",`activityId=${e}`];return s.get(`440/orders?${r.join("&")}`).then(t=>Promise.resolve(t)).catch(t=>Promise.reject(!1))},updateOrder(e,r){var n;const t={updateDate:h(new Date),isDelete:0};let a="patch",i=`600/orders/${r}`;r||(t.activityId=+e,a="post",i=`660/users/${(n=g())==null?void 0:n.id}/orders`);const c="報名";return s[a](i,t).then(d=>(o("toast","success",`${c}成功`),Promise.all([S(e),l(3)]))).catch(({status:d})=>(d!==401&&o("toast","error",`${c}失敗`),!1))},delOrder(e){const r="取消報名";return s.patch(`600/orders/${e}`,{isDelete:1}).then(t=>(o("toast","success",`${r}成功`),l(),Promise.resolve(!0))).catch(({status:t})=>(t!==401&&o("toast","error",`${r}失敗`),!1))}}});export{b as O};
