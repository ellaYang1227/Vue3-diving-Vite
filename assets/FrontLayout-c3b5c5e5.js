import{i as T,m as v,bx as M,a as S,_ as N,r as h,o as l,c as m,d as e,b as a,w as c,as as d,aO as f,an as C,ao as O,F as k,bf as g,b3 as D,L as E}from"./dateFormat-72276a92.js";import{O as V}from"./OptionStore-405834aa.js";import{M as A}from"./MemberStore-a6fe42ff.js";import{O as x}from"./bootstrap.esm-e2f1acc9.js";import{U as F}from"./UserMugShot-a7f4c140.js";import{g as I}from"./ActivityStore-099937b2.js";import{n as B}from"./runtime-dom.esm-bundler-c806efd6.js";import{s as P}from"./vue-multiselect.esm-254bf225.js";import{F as H,a as R,E as U}from"./vee-validate.esm-31b57826.js";import{P as Y}from"./PageStore-23be6fd8.js";import{f as j}from"./formSchema-19c1282a.js";import"./axiosBase-91f395ff.js";import"./VueStarRating.common-722212cb.js";import"./vue.runtime.esm-bundler-75d2e25f.js";const q="/Vue3-diving-Vite/assets/氣瓶海人logo-a9e19c9e.svg";const{VITE_COMPANY_NAME:z}={VITE_COMPANY_NAME:"氣瓶海人 水肺潛水揪團",VITE_API_ROOT:"https://vue3-diving-vite.onrender.com/",BASE_URL:"/Vue3-diving-Vite/",MODE:"production",DEV:!1,PROD:!0},W={data(){return{dateFormat:T,getMainImg:I,logo:q,VITE_COMPANY_NAME:z,offcanvasNavbar:null,hasHavbarBg:!1}},props:{showSearchBar:{type:Boolean,required:!0}},inject:["frontLayoutData"],components:{UserMugShot:F},computed:{...v(A,["myFirstThreeOrders"]),...v(M,["user"])},watch:{showSearchBar(){this.setShowSearchBar()}},mounted(){this.setShowSearchBar(),window.addEventListener("scroll",this.scrollEvent),this.offcanvasNavbar=new x(this.$refs.offcanvasNavbar,{keyboard:!1})},methods:{...S(M,["logout"]),setShowSearchBar(){this.hasHavbarBg=this.showSearchBar},scrollEvent(){this.frontLayoutData.showSearchBar||(this.hasHavbarBg=window.scrollY>0)},toggleOffcanvasNavbar(){768>document.body.clientWidth&&this.offcanvasNavbar.toggle()}}},G={class:"container"},J=["src","alt"],Q=e("span",{class:"navbar-toggler-icon"},null,-1),X=[Q],Z={class:"offcanvas-navbar offcanvas offcanvas-start border-0",tabindex:"-1",ref:"offcanvasNavbar","aria-labelledby":"offcanvasNavbarLabel"},$={class:"offcanvas-body px-0 pt-0"},K={class:"navbar-nav ms-auto align-items-md-center"},ee={class:"nav-link dropdown-toggle dropdown-hide-arrow d-flex align-items-center border-bottom border-color-dropdown",href:"#",id:"dropUser",role:"button","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},te={class:"fs-5 d-md-none mb-0 text-truncate text-primary"},se=["src","alt"],oe=e("button",{type:"button",class:"btn-close btn-close-white d-md-none ms-auto flex-shrink-0","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),ae={class:"dropdown-header fs-6 text-truncate text-primary d-none d-md-block"},re=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),ne=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),ie={class:"nav-item"},le={key:0,class:"nav-item dropdown d-none d-md-block"},ce={class:"dropdown-menu dropdown-menu-md-end","aria-labelledby":"dropMyOrders"},de={class:"list-group list-group-flush mx-3"},me={class:"row gx-2 align-items-center"},he={class:"col-4"},ue={class:"custom-rectangle border-card-border-width border"},fe=["src","alt"],pe={class:"col"},be={class:"fw-bold h6 mb-0 text-primary text-truncate-row-2"},ge={class:"font-barlow text-white"},ve={class:"nav-item"},_e={class:"nav-item"};const ye={class:"nav-item d-md-none border-top border-color-dropdown"};function we(t,o,u,b,s,r){var y;const n=h("RouterLink"),_=h("UserMugShot");return l(),m("nav",{class:f(["fixed-top navbar navbar-expand-md navbar-dark p-0",{"show-bg body-bg":s.hasHavbarBg,"shadow-lg":!u.showSearchBar&&s.hasHavbarBg}])},[e("div",G,[a(n,{class:"navbar-brand",to:"/index"},{default:c(()=>[e("img",{src:s.logo,alt:s.VITE_COMPANY_NAME,class:"mb-md-2 logo-img"},null,8,J)]),_:1}),a(n,{class:"btn btn-primary btn-custom-rectangle ms-auto me-3 me-md-0 ms-md-2 order-md-last",to:"/addActivity",role:"button"},{default:c(()=>[d("我要揪團")]),_:1}),e("button",{class:"navbar-toggler",type:"button","aria-controls":"offcanvasNavbar",onClick:o[0]||(o[0]=(...i)=>r.toggleOffcanvasNavbar&&r.toggleOffcanvasNavbar(...i))},X),e("div",Z,[e("div",$,[e("ul",K,[e("li",{class:f(["nav-item dropdown order-md-last",{"d-md-none":!t.user}])},[e("a",ee,[t.user?(l(),C(_,{key:0,"is-show-name":!1,name:t.user.name,img:t.user.img,class:"me-2"},null,8,["name","img"])):O("",!0),e("h5",te,[t.user?(l(),m(k,{key:1},[d(g(t.user.name),1)],64)):(l(),m("img",{key:0,src:s.logo,alt:s.VITE_COMPANY_NAME,class:"logo-img"},null,8,se))]),oe]),e("ul",{class:f(["dropdown-menu dropdown-menu-md-end",{"d-none":!t.user}]),"aria-labelledby":"dropUser"},[e("li",null,[e("h5",ae,g((y=t.user)==null?void 0:y.name),1)]),e("li",null,[a(n,{class:"dropdown-item",to:"/member/editMyinfo",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("編輯個人資料")]),_:1},8,["onClick"])]),e("li",null,[a(n,{class:"dropdown-item",to:"/member/editMyinfo",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("我的潛水證照")]),_:1},8,["onClick"])]),re,e("li",null,[a(n,{class:"dropdown-item",to:"/member/myActivities",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("我的揪團")]),_:1},8,["onClick"])]),e("li",null,[a(n,{class:"dropdown-item",to:"/member/myOrders",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("我的報名")]),_:1},8,["onClick"])]),e("li",null,[a(n,{class:"dropdown-item",to:"/member/myComments",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("評論管理")]),_:1},8,["onClick"])]),ne,e("li",null,[e("a",{class:"dropdown-item d-none d-md-block",href:"#",onClick:o[1]||(o[1]=B((...i)=>t.logout&&t.logout(...i),["prevent"]))},"登出")])],2)],2),e("li",ie,[a(n,{class:"nav-link",to:"/activities",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("找揪團")]),_:1},8,["onClick"])]),t.user?(l(),m("li",le,[a(n,{class:f(["nav-link",{"dropdown-toggle dropdown-hide-arrow":t.myFirstThreeOrders.length}]),id:"dropMyOrders",role:"button","data-bs-toggle":t.myFirstThreeOrders.length?"dropdown":"","data-bs-display":"static","aria-expanded":"false",to:"/member/myOrders"},{default:c(()=>[d(" 我的報名 ")]),_:1},8,["class","data-bs-toggle"]),e("div",ce,[e("div",de,[(l(!0),m(k,null,D(t.myFirstThreeOrders,i=>(l(),C(n,{to:`/activity/${i.activityId}`,class:"list-group-item list-group-item-action bg-transparent px-0 py-3",key:i.id},{default:c(()=>[e("div",me,[e("div",he,[e("div",ue,[e("img",{src:s.getMainImg(i.activity.imgs).img,alt:i.activity.title,class:"custom-rectangle img-cover"},null,8,fe)])]),e("div",pe,[e("h2",be,g(i.activity.title),1),e("small",ge,g(s.dateFormat(i.activity.startDate))+" ~ "+g(s.dateFormat(i.activity.endDate)),1)])])]),_:2},1032,["to"]))),128))]),a(n,{class:"py-2 d-block text-center text-decoration-none bg-lightPrimary bg-opacity-20 text-body border-top border-color-dropdown",to:"/member/myOrders"},{default:c(()=>[d("更多我的報名")]),_:1})])])):O("",!0),t.user?(l(),m(k,{key:2},[(t.user.identityId,O("",!0)),e("li",ye,[e("a",{class:"nav-link",href:"#",onClick:o[2]||(o[2]=B(i=>{r.toggleOffcanvasNavbar(),t.logout()},["prevent"]))},"登出")])],64)):(l(),m(k,{key:1},[e("li",ve,[a(n,{class:"nav-link",to:"/login",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("登入")]),_:1},8,["onClick"])]),e("li",_e,[a(n,{class:"nav-link",to:"/signup",onClick:r.toggleOffcanvasNavbar},{default:c(()=>[d("註冊")]),_:1},8,["onClick"])])],64))])])],512)])],2)}const ke=N(W,[["render",we]]),{VITE_COMPANY_NAME:Oe}={VITE_COMPANY_NAME:"氣瓶海人 水肺潛水揪團",VITE_API_ROOT:"https://vue3-diving-vite.onrender.com/",BASE_URL:"/Vue3-diving-Vite/",MODE:"production",DEV:!1,PROD:!0},Se={data(){return{VITE_COMPANY_NAME:Oe}}},Ne={class:"bg-primary bg-opacity-20 text-center py-2 fs-7"},Me={class:"d-block"},Ce=e("span",null,"資料、圖片、來源皆來自網路，僅用來做為學習用途",-1);function Ve(t,o,u,b,s,r){return l(),m("div",Ne,[e("span",Me,"© 2022 "+g(s.VITE_COMPANY_NAME)+". All Rights Reserved.",1),Ce])}const Ee=N(Se,[["render",Ve]]),Be={data(){return{formSchema:j,location:null,search:{locationId:"",startDate:"",endDate:"",tag:""}}},computed:{...v(E,["isLoadingBtn"]),...v(V,["locations","tags"]),...v(Y,["hasActivityHavbar"]),selectedTag(){return this.search.tag}},components:{VueMultiselect:P,VForm:H,Field:R,ErrorMessage:U},created(){this.$watch(()=>this.$route.query,()=>{const{path:t}=this.$route;t.indexOf("/activities")>-1?this.setLocation():(this.location=null,this.search={locationId:"",startDate:"",endDate:"",tag:""})},{immediate:!0})},methods:{...S(E,["showLoading"]),setLocation(){this.search={...this.$route.query};const{locationId:t}=this.search,o=this.locations.find(u=>u.id===t);this.location=o||""},updateSelectedTag(t){const{value:o}=t.target;this.search.tag=o!==this.search.tag?o:"",this.onSubmit()},updateLocation(t){this.location=t,this.search.locationId=t==null?void 0:t.id},onSubmit(){this.showLoading("btn");const t=Object.keys(this.search).reduce((u,b)=>(this.search[b]&&(u[b]=this.search[b]),u),{});let o={path:"/activities"};Object.keys(this.search).length&&(o.query=t),this.$router.push(o)}}},De=e("div",{class:"border-top opacity-30"},null,-1),Ae={class:"container py-4"},Le=["disabled"],Te={class:"col-md col-lg-6 col-xl-5"},xe={class:"col"},Fe={class:"input-group"},Ie={class:"col-sm-auto"},Pe=["disabled"],He={key:0,class:"spinner-border spinner-border-sm",role:"status"},Re={class:"row gx-2 gy-1 d-none d-md-flex"},Ue=["id","value","checked"],Ye=["for"];function je(t,o,u,b,s,r){const n=h("VueMultiselect"),_=h("Field"),y=h("ErrorMessage"),i=h("VForm");return l(),m("div",{class:f(["body-bg shadow-lg",{"sticky-top sticky-top-headerHeight":!t.hasActivityHavbar}])},[De,e("div",Ae,[a(i,{onSubmit:r.onSubmit,class:"pb-1"},{default:c(({errors:p})=>[e("fieldset",{disabled:t.isLoadingBtn,class:"row g-2"},[e("div",Te,[a(n,{options:t.locations,placeholder:`請輸入${s.formSchema.search.location.label}`,label:s.formSchema.search.location.optionLabel,"track-by":s.formSchema.search.location.optionLabel,disabled:t.isLoadingBtn,"model-value":s.location,"onUpdate:modelValue":r.updateLocation},{noResult:c(()=>[d("沒有符合條件的結果")]),_:1},8,["options","placeholder","label","track-by","disabled","model-value","onUpdate:modelValue"])]),e("div",xe,[e("div",Fe,[a(_,{id:s.formSchema.search.startDate.name,name:s.formSchema.search.startDate.label,type:s.formSchema.search.startDate.type,as:s.formSchema.search.startDate.as,class:f(["form-control",{"is-invalid":p[s.formSchema.search.startDate.label]}]),rules:s.formSchema.search.startDate.rules,modelValue:s.search.startDate,"onUpdate:modelValue":o[0]||(o[0]=w=>s.search.startDate=w)},null,8,["id","name","type","as","class","rules","modelValue"]),a(_,{id:s.formSchema.search.endDate.name,name:s.formSchema.search.endDate.label,type:s.formSchema.search.endDate.type,as:s.formSchema.search.endDate.as,class:f(["form-control",{"is-invalid":p[s.formSchema.search.endDate.label]}]),rules:s.formSchema.search.endDate.rules,modelValue:s.search.endDate,"onUpdate:modelValue":o[1]||(o[1]=w=>s.search.endDate=w)},null,8,["id","name","type","as","class","rules","modelValue"])]),a(y,{name:s.formSchema.search.startDate.label,class:"invalid-feedback d-block"},null,8,["name"])]),e("div",Ie,[e("button",{type:"submit",class:"btn btn-outline-warning rounded-0 w-100",disabled:t.isLoadingBtn||Object.keys(p).length},[t.isLoadingBtn?(l(),m("span",He)):O("",!0),d(" 搜出好團 ")],8,Pe)])],8,Le)]),_:1},8,["onSubmit"]),e("div",Re,[(l(!0),m(k,null,D(t.tags,(p,w)=>(l(),m("div",{class:"col-auto",key:p},[e("input",{type:"radio",class:"btn-check",name:"tagOptions",id:`tagOption-${w}`,autocomplete:"off",value:p,onClick:o[2]||(o[2]=(...L)=>r.updateSelectedTag&&r.updateSelectedTag(...L)),checked:p===r.selectedTag},null,8,Ue),e("label",{class:"btn btn-outline-lightPrimary btn-sm rounded-0 px-1 py-0",for:`tagOption-${w}`},g(p),9,Ye)]))),128))])])],2)}const qe=N(Be,[["render",je]]),ze={data(){return{isVerticalMiddle:!1,showSearchBar:!0,isMainOverflowHidden:!1}},provide(){return{frontLayoutData:this}},computed:{...v(V,["locations","tags"]),...v(M,["user"])},components:{HeaderNavbar:ke,FooterComponent:Ee,SearchActivityBar:qe},created(){var o;this.$watch(()=>this.$route.params,()=>{this.isVerticalMiddle=!1,this.showSearchBar=!0,this.isMainOverflowHidden=!1},{immediate:!0});const t=[this.getLocations(),this.getTags()];(o=this.user)!=null&&o.id&&t.push(this.getMyOrders(3)),Promise.all(t)},methods:{...S(V,["getLocations","getTags"]),...S(A,["getMyOrders"])}};function We(t,o,u,b,s,r){const n=h("HeaderNavbar"),_=h("SearchActivityBar"),y=h("RouterView"),i=h("FooterComponent");return l(),m("div",{class:f(["min-vh-100 d-flex flex-column",{"overflow-hidden":s.isMainOverflowHidden}])},[a(n,{"show-search-bar":s.showSearchBar},null,8,["show-search-bar"]),e("div",{class:f(["flex-fill fixed-margin-top-headerHeight",{"d-flex flex-column justify-content-center":s.isVerticalMiddle}])},[s.showSearchBar?(l(),C(_,{key:0})):O("",!0),a(y)],2),a(i)],2)}const it=N(ze,[["render",We]]);export{it as default};
