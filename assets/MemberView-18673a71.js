import{_ as S,o as n,c as r,d as t,bf as i,m as _,bx as V,a as h,L as M,b as u,F as p,b3 as b,r as d,an as O,w as N,as as A}from"./dateFormat-72276a92.js";import{M as g}from"./MemberStore-a6fe42ff.js";import{C as w,d as I}from"./decimalFormat-f2a00fd2.js";import{a as L}from"./routeGuard-0f827432.js";import{U as j}from"./UserMugShot-a7f4c140.js";import"./axiosBase-91f395ff.js";import"./ActivityStore-099937b2.js";import"./VueStarRating.common-722212cb.js";import"./vue.runtime.esm-bundler-75d2e25f.js";import"./runtime-dom.esm-bundler-c806efd6.js";const R="/Vue3-diving-Vite/assets/activities-0a86f140.svg",B="/Vue3-diving-Vite/assets/commentScore-124609f6.svg",U="/Vue3-diving-Vite/assets/myOrders-45c70b3d.svg",D="/Vue3-diving-Vite/assets/orders-00cc1571.svg";const E={props:["title","imgName","value"],computed:{imgSrc(){if(this.imgName==="activitiesIcon")return R;if(this.imgName==="commentScoreIcon")return B;if(this.imgName==="myOrdersIcon")return U;if(this.imgName==="ordersIcon")return D}}},F={class:"card"},P={class:"card-body p-2 p-sm-3"},T={class:"row g-2 justify-content-between justify-content-sm-center align-items-center"},q={class:"col-auto col-sm text-center"},z=["src","alt"],G={class:"col"},H={class:"fs-3 font-barlow"},J={class:"d-block opacity-80"};function K(e,o,s,m,a,l){return n(),r("div",F,[t("div",P,[t("div",T,[t("div",q,[t("img",{src:l.imgSrc,alt:s.title,class:"icon-height"},null,8,z)]),t("div",G,[t("strong",H,i(s.value),1),t("small",J,i(s.title),1)])])])])}const Q=S(E,[["render",K]]);const W=g(),X={data(){return{cards:{myOrders:{title:"報名揪團次數",value:null},commentScore:{title:"評價分數",value:null},activities:{title:"累積揪團數",value:null},orders:{title:"累積報名人數",value:null}},navTabs:[{name:"我的揪團",url:"/myActivities"},{name:"我的報名",url:"/myOrders"},{name:"評論管理",url:"/myComments"},{name:"編輯個人檔案",url:"/editMyinfo"}]}},beforeRouteEnter(e,o,s){L(e,o,s)},computed:{..._(V,["user"]),..._(g,["myinfo","myComments","myActivities","myOrders"]),..._(w,["initComments","comments"])},watch:{comments(){const{id:e}=this.user;W.$patch(o=>{o.myComments=this.comments.find(s=>s.userId==e)})},myOrders(){this.setCards()},myComments(){this.setCards()},myActivities(){this.setCards()}},components:{UserMugShot:j,StatisticsCard:Q},created(){this.$watch(()=>this.$route.query,()=>{const{path:e}=this.$route;e.indexOf("/member")>-1&&this.fetchData()},{immediate:!0})},methods:{...h(M,["showLoading","hideLoading"]),...h(g,["getMyinfo","getMyActivities","getMyOrders"]),...h(w,["getComments"]),fetchData(){Promise.all([this.getMyinfo(),this.getComments(),this.getMyActivities(),this.getMyOrders()]).then(e=>{this.setCards(),this.hideLoading()})},setCards(){Object.keys(this.cards).forEach(o=>{var m;let s=0;switch(o){case"myOrders":s=this.myOrders.length;break;case"commentScore":(m=this.myComments)!=null&&m.averageScore&&(s=I(this.myComments.averageScore,1));break;case"activities":s=this.myActivities.length;break;case"orders":s=this.myActivities.reduce((a,l)=>a+l.orders.length,0);break}this.cards[o].value=s})}}},Y={class:"container py-4 py-md-5"},Z={class:"row gy-2 gy-sm-4 align-items-stretch"},tt={class:"col-md-12 col-lg-5"},et={class:"card h-100"},st={class:"row g-0 h-100"},ot={class:"col-sm-5 col-lg-6 col-xl-5 text-center"},it={class:"bg-lightPrimary bg-opacity-5 h-100 p-3 custom-rectangle d-flex flex-sm-column justify-content-center align-items-center"},ct={class:"text-truncate flex-grow-1 flex-sm-grow-0 text-start text-sm-center mt-sm-2"},nt={class:"fw-bold mb-0 text-truncate"},at={class:"font-barlow"},rt={class:"col-sm"},mt={class:"card-body list-unstyled mb-0 h-100 d-flex flex-column justify-content-center"},lt={class:"d-flex justify-content-between align-items-center"},dt=t("small",{class:"opacity-80"},"證照等級",-1),_t={class:"ms-2"},ht={class:"d-flex justify-content-between align-items-center py-2"},ut=t("small",{class:"opacity-80"},"持有高氧證照",-1),gt={class:"ms-2"},yt={class:"d-flex justify-content-between align-items-center"},vt=t("small",{class:"opacity-80"},"潛水支數",-1),ft={class:"ms-2"},pt={class:"col"},bt={class:"row row-cols-2 g-2 g-sm-4"},wt={class:"pt-4 pt-md-5"},St={class:"nav nav-tabs member-nav-tabs"},xt={class:"card border-top-0"},Ct={class:"card-body p-4 px-md-5"};function $t(e,o,s,m,a,l){var y,v;const x=d("UserMugShot"),C=d("StatisticsCard"),$=d("RouterLink"),k=d("RouterView");return n(),r("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("div",ot,[t("div",it,[u(x,{img:e.myinfo.img,isShowName:!1,widthSize:75,class:"flex-shrink-0 me-2 me-sm-0"},null,8,["img"]),t("div",ct,[t("h5",nt,i(e.myinfo.name),1),t("small",at,i(e.myinfo.email),1)])])]),t("div",rt,[t("ul",mt,[t("li",lt,[dt,t("strong",_t,i((y=e.myinfo.certificateLevel)==null?void 0:y.name),1)]),t("li",ht,[ut,t("strong",gt,i(e.myinfo.isNitrox?"是":"否"),1)]),t("li",yt,[vt,t("strong",ft,i((v=e.myinfo.cylinderTotal)==null?void 0:v.name),1)])])])])])]),t("div",pt,[t("div",bt,[(n(!0),r(p,null,b(a.cards,(c,f)=>(n(),r("div",{class:"col",key:f},[u(C,{title:c.title,imgName:`${f}Icon`,value:c.value},null,8,["title","imgName","value"])]))),128))])])]),t("div",wt,[t("nav",St,[(n(!0),r(p,null,b(a.navTabs,c=>(n(),O($,{class:"nav-link",to:`/member${c.url}`,key:c.name},{default:N(()=>[A(i(c.name),1)]),_:2},1032,["to"]))),128))]),t("div",xt,[t("div",Ct,[u(k)])])])])}const Bt=S(X,[["render",$t]]);export{Bt as default};
