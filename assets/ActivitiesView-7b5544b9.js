import{s as C}from"./vue-multiselect.esm-254bf225.js";import{_ as x,i as D,r as v,o as a,an as _,w as P,d as e,bf as l,c as n,ao as h,b as w,as as A,F as d,aO as g,m as V,a as f,L as T,b3 as b}from"./dateFormat-72276a92.js";import{g as N,b as M,A as F}from"./ActivityStore-099937b2.js";import{d as z,C as k}from"./decimalFormat-f2a00fd2.js";import{s as L}from"./statusTextFormat-746565ff.js";import{p as O}from"./propsValidator-40732aba.js";import{U as B}from"./UserMugShot-a7f4c140.js";import{N as H}from"./NoData-ab382a5f.js";import{n as p}from"./runtime-dom.esm-bundler-c806efd6.js";import"./axiosBase-91f395ff.js";import"./VueStarRating.common-722212cb.js";import"./vue.runtime.esm-bundler-75d2e25f.js";const I={data(){return{dateFormat:D,decimalFormat:z,statusBtnTextFormat:L,getMainImg:N}},props:{activity:{type:Object,required:!0,validator(o){return O("HorizontalActivityCard",o,["id","title","imgs","location","startDate","endDate","isNitrox","cylinderTotalId","user"])}}},components:{UserMugShot:B}},U={class:"card horizontal-card h-100"},q={class:"row g-0"},R={class:"col-sm-5 position-relative overflow-hidden"},j=["src","alt"],K=e("div",{class:"img-mask"},null,-1),E={class:"position-absolute top-0 end-0 p-1 bg-darkPrimary bg-opacity-80 fs-7 text-body"},G={class:"col-sm-7"},J={class:"card-body h-100 d-flex flex-column"},Q={class:"font-barlow"},W={class:"card-title h5 mb-0 text-primary text-truncate-row-2 fw-bold"},X={key:0,class:"card-text text-truncate-row-2 white-space-pre-wrap opacity-75 mb-0"},Y={class:"row align-items-center fw-bold mt-2 mt-sm-auto"},Z={class:"col text-truncate d-flex align-items-center"},$={key:0,class:"ms-1 font-barlow fw-normal"},tt={class:"col-auto font-barlow list-inline mb-0"},et={class:"list-inline-item"},it={key:0,class:"list-inline-item"},st={key:1,class:"list-inline-item"};function at(o,s,t,r,i,m){const y=v("UserMugShot"),u=v("RouterLink");return a(),_(u,{to:`/activity/${t.activity.id}`,class:"col text-decoration-none shadow-sm card-hover"},{default:P(()=>[e("div",U,[e("div",q,[e("div",R,[e("img",{src:i.getMainImg(t.activity.imgs).img,class:"img-fluid img-cover",alt:t.activity.title},null,8,j),K,e("div",E,l(t.activity.location.name),1)]),e("div",G,[e("div",J,[e("small",Q,l(i.dateFormat(t.activity.startDate))+" ~ "+l(i.dateFormat(t.activity.endDate)),1),e("h2",W,l(t.activity.title),1),t.activity.features?(a(),n("p",X,l(t.activity.features),1)):h("",!0),e("div",Y,[e("div",Z,[w(y,{"width-size":30,name:t.activity.user.name,img:t.activity.user.img},null,8,["name","img"]),t.activity.score?(a(),n("small",$,l(`(${i.decimalFormat(t.activity.score,1)})`),1)):h("",!0)]),e("ul",tt,[e("li",et,l(t.activity.certificateLevel.name),1),t.activity.isNitrox?(a(),n("li",it,"高氧")):h("",!0),t.activity.cylinderTotalId?(a(),n("li",st,l(t.activity.cylinderTotal.name),1)):h("",!0)])]),w(u,{to:`/activity/${t.activity.id}`,class:g(["btn btn-custom-rectangle mt-3",t.activity.isOrderPlaced||t.activity.orderStatus!==2?"btn-lightPrimary opacity-40":"btn-primary"]),role:"button"},{default:P(()=>[t.activity.isOrderPlaced?(a(),n(d,{key:0},[A("已報名")],64)):(a(),n(d,{key:1},[A(l(i.statusBtnTextFormat(t.activity.activityStatus,t.activity.orderStatus).replace("立即報名","揪團詳情")),1)],64))]),_:1},8,["to","class"])])])])])]),_:1},8,["to"])}const ot=x(I,[["render",at]]),ct={data(){return{activities:{all:[],paging:[],totalPage:0,currentPage:1,perPage:10},initAdActivities:[],adActivities:[],selectedSort:"",sortOptions:[{label:"更新時間",value:"updateDate"},{label:"出發時間",value:"startDate"},{label:"評論分數",value:"score"},{label:"報名人數",value:"orderTotal"}]}},computed:{...V(k,["comments"]),pagingActivities(){const{all:o,currentPage:s,perPage:t}=this.activities,r=(s-1)*t,i=s*t;return o.slice(r,i)}},watch:{selectedSort:{handler(o,s){if(o){const{value:t}=o;this.activities.all.sort((r,i)=>t==="startDate"?r[t]>i[t]?1:-1:t==="orderTotal"?r.orders.length>i.orders.length?-1:1:r[t]>i[t]?-1:1),this.activities.currentPage=1,this.adActivities=M(this.initAdActivities,2)}}}},components:{VueMultiselect:C,HorizontalActivityCard:ot,NoData:H},created(){this.$watch(()=>this.$route.query,()=>{const{path:o}=this.$route;o.indexOf("/activities")>-1&&this.fetchData()},{immediate:!0})},methods:{...f(T,["hideLoading"]),...f(F,["getActivities","getAdActivities"]),...f(k,["getComments","setScore"]),fetchData(){this.selectedSort=null;const o=[this.getActivities(this.$route.query),this.getComments()];this.initAdActivities.length||o.push(this.getAdActivities()),Promise.all(o).then(s=>{this.activities={...this.activities,currentPage:1,totalPage:Math.ceil(s[0].length/this.activities.perPage),all:this.setScore(s[0])},this.initAdActivities.length||(this.initAdActivities=this.setScore(s[2])),this.selectedSort=this.sortOptions[0],this.hideLoading()})},goToPage(o){this.activities.currentPage=o}}},nt={class:"container py-4 py-md-5"},lt={class:"row align-items-center mb-2"},rt=e("h5",{class:"col fw-bold fs-4 mb-0 text-warning"},"為您精選",-1),dt={class:"col-auto btn-group ms-auto"},mt={class:"row row-cols-1 row-cols-md-2 gy-4"},ut=e("div",{class:"border-bottom opacity-30 my-4"},null,-1),vt={class:"row row-cols-1 row-cols-md-2 gy-4"},ht={"aria-label":"Page navigation example",class:"mt-4 mb-0"},_t={class:"pagination pagination-sm justify-content-center"},gt=e("span",{"aria-hidden":"true"},"«",-1),yt=[gt],ft=["onClick"],bt=e("span",{"aria-hidden":"true"},"»",-1),pt=[bt];function wt(o,s,t,r,i,m){const y=v("VueMultiselect"),u=v("HorizontalActivityCard"),S=v("NoData");return a(),n("div",nt,[e("div",lt,[rt,e("div",dt,[w(y,{modelValue:i.selectedSort,"onUpdate:modelValue":s[0]||(s[0]=c=>i.selectedSort=c),options:i.sortOptions,label:"label","track-by":"label",searchable:!1},null,8,["modelValue","options"])])]),e("div",mt,[(a(!0),n(d,null,b(i.adActivities,c=>(a(),_(u,{activity:c,key:c.id},null,8,["activity"]))),128))]),ut,i.activities.all.length?(a(),n(d,{key:0},[e("div",vt,[(a(!0),n(d,null,b(m.pagingActivities,c=>(a(),_(u,{activity:c,key:c.id},null,8,["activity"]))),128))]),e("nav",ht,[e("ul",_t,[e("li",{class:g(["page-item",{disabled:i.activities.currentPage===1}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:s[1]||(s[1]=p(c=>m.goToPage(i.activities.currentPage-1),["prevent"]))},yt)],2),(a(!0),n(d,null,b(i.activities.totalPage,c=>(a(),n("li",{class:g(["page-item",{active:i.activities.currentPage===c}]),key:c},[e("a",{class:"page-link",href:"#",onClick:p(Pt=>m.goToPage(c),["prevent"])},l(c),9,ft)],2))),128)),e("li",{class:g(["page-item",{disabled:i.activities.currentPage===i.activities.totalPage}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:s[2]||(s[2]=p(c=>m.goToPage(i.activities.currentPage+1),["prevent"]))},pt)],2)])])],64)):(a(),_(S,{key:1,text:"找不到符合條件的揪團活動，試試看其他搜尋條件吧"}))])}const Lt=x(ct,[["render",wt]]);export{Lt as default};
